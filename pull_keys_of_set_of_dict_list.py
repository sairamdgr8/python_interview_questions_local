import re
st1=[{'id': '36537106158412498053213177022655670018468498077717299200', 'timestamp': 1638380504021, 'message': '*** Running the Snowflake job ***'}, {'id': '36537106158412498053213177022655670018468498077717299201', 'timestamp': 1638380504021, 'message': 'RootFolder|/snowflakecicd/demo/trips|ACCOUNT|poa50069.us-east-1|User|annadavid2021|ROLE|SYSADMIN|DB|DEMO|WAREHOUSE|COMPUTE_WH'}, {'id': '36537106224511906821657944014167538978598241581443252226', 'timestamp': 1638380506985, 'message': 'schemachange version: 2.9.2'}, {'id': '36537106224511906821657944014167538978598241581443252227', 'timestamp': 1638380506985, 'message': 'Using root folder /snowflakecicd/demo/trips'}, {'id': '36537106224511906821657944014167538978598241581443252228', 'timestamp': 1638380506985, 'message': 'Using variables None'}, {'id': '36537106224511906821657944014167538978598241581443252229', 'timestamp': 1638380506985, 'message': 'Using Snowflake account poa50069.us-east-1'}, {'id': '36537106224511906821657944014167538978598241581443252230', 'timestamp': 1638380506985, 'message': 'Using default role SYSADMIN'}, {'id': '36537106224511906821657944014167538978598241581443252231', 'timestamp': 1638380506985, 'message': 'Using default warehouse COMPUTE_WH'}, {'id': '36537106224511906821657944014167538978598241581443252232', 'timestamp': 1638380506985, 'message': 'Using default database DEMO'}, {'id': '36537106224511906821657944014167538978598241581443252233', 'timestamp': 1638380506985, 'message': 'Traceback (most recent call last):'}, {'id': '36537106224511906821657944014167538978598241581443252234', 'timestamp': 1638380506985, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 375, in <module>'}, {'id': '36537106224511906821657944014167538978598241581443252235', 'timestamp': 1638380506985, 'message': '    main()'}, {'id': '36537106224511906821657944014167538978598241581443252236', 'timestamp': 1638380506985, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 372, in main'}, {'id': '36537106224511906821657944014167538978598241581443252237', 'timestamp': 1638380506985, 'message': '    schemachange(args.root_folder, args.snowflake_account, args.snowflake_user, args.snowflake_role, args.snowflake_warehouse, args.snowflake_database, args.change_history_table, args.vars, args.create_change_history_table, args.autocommit, args.verbose, args.dry_run)'}, {'id': '36537106224511906821657944014167538978598241581443252238', 'timestamp': 1638380506985, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 74, in schemachange'}, {'id': '36537106224511906821657944014167538978598241581443252239', 'timestamp': 1638380506985, 'message': '    change_history_metadata = fetch_change_history_metadata(change_history_table, snowflake_session_parameters, autocommit, verbose)'}, {'id': '36537106224511906821657944014167538978598241581443252240', 'timestamp': 1638380506985, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 280, in fetch_change_history_metadata'}, {'id': '36537106224534207566856474637309074696870889942949232657', 'timestamp': 1638380506986, 'message': "    results = execute_snowflake_query(change_history_table['database_name'], query, snowflake_session_parameters, autocommit, verbose)"}, {'id': '36537106224534207566856474637309074696870889942949232658', 'timestamp': 1638380506986, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 194, in execute_snowflake_query'}, {'id': '36537106224534207566856474637309074696870889942949232659', 'timestamp': 1638380506986, 'message': '    con = snowflake.connector.connect('}, {'id': '36537106224534207566856474637309074696870889942949232660', 'timestamp': 1638380506986, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/__init__.py", line 50, in Connect'}, {'id': '36537106224534207566856474637309074696870889942949232661', 'timestamp': 1638380506986, 'message': '    return SnowflakeConnection(**kwargs)'}, {'id': '36537106224534207566856474637309074696870889942949232662', 'timestamp': 1638380506986, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 273, in __init__'}, {'id': '36537106224534207566856474637309074696870889942949232663', 'timestamp': 1638380506986, 'message': '    self.connect(**kwargs)'}, {'id': '36537106224534207566856474637309074696870889942949232664', 'timestamp': 1638380506986, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 484, in connect'}, {'id': '36537106224534207566856474637309074696870889942949232665', 'timestamp': 1638380506986, 'message': '    self.__open_connection()'}, {'id': '36537106224534207566856474637309074696870889942949232666', 'timestamp': 1638380506986, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 723, in __open_connection'}, {'id': '36537106224534207566856474637309074696870889942949232667', 'timestamp': 1638380506986, 'message': '    self._authenticate(auth_instance)'}, {'id': '36537106224534207566856474637309074696870889942949232668', 'timestamp': 1638380506986, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 984, in _authenticate'}, {'id': '36537106224556508312055005260450610415143538304455213085', 'timestamp': 1638380506987, 'message': '    self.__authenticate(self.__preprocess_auth_instance(auth_instance))'}, {'id': '36537106224556508312055005260450610415143538304455213086', 'timestamp': 1638380506987, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 1003, in __authenticate'}, {'id': '36537106224556508312055005260450610415143538304455213087', 'timestamp': 1638380506987, 'message': '    auth.authenticate('}, {'id': '36537106224556508312055005260450610415143538304455213088', 'timestamp': 1638380506987, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/auth.py", line 380, in authenticate'}, {'id': '36537106224556508312055005260450610415143538304455213089', 'timestamp': 1638380506987, 'message': '    Error.errorhandler_wrapper('}, {'id': '36537106224556508312055005260450610415143538304455213090', 'timestamp': 1638380506987, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/errors.py", line 261, in errorhandler_wrapper'}, {'id': '36537106224734914273643250245582896161324725196503056419', 'timestamp': 1638380506995, 'message': '    connection.errorhandler(connection, cursor, error_class, error_value)'}, {'id': '36537106224734914273643250245582896161324725196503056420', 'timestamp': 1638380506995, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/errors.py", line 188, in default_errorhandler'}, {'id': '36537106224734914273643250245582896161324725196503056421', 'timestamp': 1638380506995, 'message': '    raise error_class('}, {'id': '36537106224734914273643250245582896161324725196503056422', 'timestamp': 1638380506995, 'message': 'snowflake.connector.errors.DatabaseError: 250001 (08001): Failed to connect to DB: poa50069.us-east-1.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.'}, {'id': '36537106233610610862658438255914112033838773075883261991', 'timestamp': 1638380507393, 'message': '*** Snowflake job completed ***'}]

st1=[{'id': '36540312098846047729764497341480181085314935000079925248', 'timestamp': 1638524263362, 'message': 'schemachange version: 2.9.2'}, {'id': '36540312098846047729764497341480181085314935000079925249', 'timestamp': 1638524263362, 'message': 'Using root folder /snowflakecicd/demo/trips'}, {'id': '36540312098846047729764497341480181085314935000079925250', 'timestamp': 1638524263362, 'message': 'Using variables None'}, {'id': '36540312098846047729764497341480181085314935000079925251', 'timestamp': 1638524263362, 'message': 'Using Snowflake account wg12189.us-east-2.aws'}, {'id': '36540312098846047729764497341480181085314935000079925252', 'timestamp': 1638524263362, 'message': 'Using default role SYSADMIN'}, {'id': '36540312098846047729764497341480181085314935000079925253', 'timestamp': 1638524263362, 'message': 'Using default warehouse COMPUTE_WH'}, {'id': '36540312098846047729764497341480181085314935000079925254', 'timestamp': 1638524263362, 'message': 'Using default database DEMO'}, {'id': '36540312098846047729764497341480181085314935000079925255', 'timestamp': 1638524263362, 'message': 'Using change history table METADATA.SCHEMACHANGE.CHANGE_HISTORY (last altered 2021-12-03 01:29:58.535000-08:00)'}, {'id': '36540312098846047729764497341480181085314935000079925256', 'timestamp': 1638524263362, 'message': 'Max applied change script version: 1.27'}, {'id': '36540312098846047729764497341480181085314935000079925257', 'timestamp': 1638524263362, 'message': 'Applying change script V1.28__createTable1.sql'}, {'id': '36540312098846047729764497341480181085314935000079925258', 'timestamp': 1638524263362, 'message': 'Traceback (most recent call last):'}, {'id': '36540312098846047729764497341480181085314935000079925259', 'timestamp': 1638524263362, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 375, in <module>'}, {'id': '36540312098846047729764497341480181085314935000079925260', 'timestamp': 1638524263362, 'message': '    main()'}, {'id': '36540312098846047729764497341480181085314935000079925261', 'timestamp': 1638524263362, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 372, in main'}, {'id': '36540312098846047729764497341480181085314935000079925262', 'timestamp': 1638524263362, 'message': '    schemachange(args.root_folder, args.snowflake_account, args.snowflake_user, args.snowflake_role, args.snowflake_warehouse, args.snowflake_database, args.change_history_table, args.vars, args.create_change_history_table, args.autocommit, args.verbose, args.dry_run)'}, {'id': '36540312098846047729764497341480181085314935000079925263', 'timestamp': 1638524263362, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 120, in schemachange'}, {'id': '36540312098846047729764497341480181085314935000079925264', 'timestamp': 1638524263362, 'message': '    apply_change_script(script, vars, snowflake_database, change_history_table, snowflake_session_parameters, autocommit, verbose)'}, {'id': '36540312098846047729764497341480181085314935000079925265', 'timestamp': 1638524263362, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 340, in apply_change_script'}, {'id': '36540312098846047729764497341480181085314935000079925266', 'timestamp': 1638524263362, 'message': '    execute_snowflake_query(default_database, content, session_parameters, autocommit, verbose)'}, {'id': '36540312098846047729764497341480181085314935000079925267', 'timestamp': 1638524263362, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 248, in execute_snowflake_query'}, {'id': '36540312098868348474963027964621716803587583361585905684', 'timestamp': 1638524263363, 'message': '    raise e'}, {'id': '36540312098868348474963027964621716803587583361585905685', 'timestamp': 1638524263363, 'message': '  File "/snowflakecicd/schemachange/cli.py", line 241, in execute_snowflake_query'}, {'id': '36540312098868348474963027964621716803587583361585905686', 'timestamp': 1638524263363, 'message': '    res = con.execute_string(query)'}, {'id': '36540312098868348474963027964621716803587583361585905687', 'timestamp': 1638524263363, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 603, in execute_string'}, {'id': '36540312098868348474963027964621716803587583361585905688', 'timestamp': 1638524263363, 'message': '    ret = list(stream_generator)'}, {'id': '36540312098868348474963027964621716803587583361585905689', 'timestamp': 1638524263363, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/connection.py", line 621, in execute_stream'}, {'id': '36540312098868348474963027964621716803587583361585905690', 'timestamp': 1638524263363, 'message': '    cur.execute(sql, _is_put_get=is_put_or_get, **kwargs)'}, {'id': '36540312098868348474963027964621716803587583361585905691', 'timestamp': 1638524263363, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/cursor.py", line 781, in execute'}, {'id': '36540312098868348474963027964621716803587583361585905692', 'timestamp': 1638524263363, 'message': '    Error.errorhandler_wrapper('}, {'id': '36540312098868348474963027964621716803587583361585905693', 'timestamp': 1638524263363, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/errors.py", line 269, in errorhandler_wrapper'}, {'id': '36540312098868348474963027964621716803587583361585905694', 'timestamp': 1638524263363, 'message': '    handed_over = Error.hand_to_other_handler('}, {'id': '36540312098868348474963027964621716803587583361585905695', 'timestamp': 1638524263363, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/errors.py", line 324, in hand_to_other_handler'}, {'id': '36540312098890649220161558587763252521860231723091886112', 'timestamp': 1638524263364, 'message': '    cursor.errorhandler(connection, cursor, error_class, error_value)'}, {'id': '36540312098890649220161558587763252521860231723091886113', 'timestamp': 1638524263364, 'message': '  File "/usr/local/lib/python3.9/site-packages/snowflake/connector/errors.py", line 203, in default_errorhandler'}, {'id': '36540312098890649220161558587763252521860231723091886114', 'timestamp': 1638524263364, 'message': '    raise error_class('}, {'id': '36540312098890649220161558587763252521860231723091886115', 'timestamp': 1638524263364, 'message': 'snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:'}, {'id': '36540312098890649220161558587763252521860231723091886116', 'timestamp': 1638524263364, 'message': "syntax error line 1 at position 0 unexpected 'CREATEE'."}, {'id': '36540312105826180976904582384780860904653872151451795493', 'timestamp': 1638524263675, 'message': '*** Snowflake job completed ***'}]

st3=[{'id': '36540301736827091977708984686545449838273515917612744704', 'timestamp': 1638523798713, 'message': 'schemachange version: 2.9.2'}, {'id': '36540301736827091977708984686545449838273515917612744705', 'timestamp': 1638523798713, 'message': 'Using root folder /snowflakecicd/demo/trips'}, {'id': '36540301736827091977708984686545449838273515917612744706', 'timestamp': 1638523798713, 'message': 'Using variables None'}, {'id': '36540301736827091977708984686545449838273515917612744707', 'timestamp': 1638523798713, 'message': 'Using Snowflake account wg12189.us-east-2.aws'}, {'id': '36540301736827091977708984686545449838273515917612744708', 'timestamp': 1638523798713, 'message': 'Using default role SYSADMIN'}, {'id': '36540301736827091977708984686545449838273515917612744709', 'timestamp': 1638523798713, 'message': 'Using default warehouse COMPUTE_WH'}, {'id': '36540301736827091977708984686545449838273515917612744710', 'timestamp': 1638523798713, 'message': 'Using default database DEMO'}, {'id': '36540301736827091977708984686545449838273515917612744711', 'timestamp': 1638523798713, 'message': 'Created change history table METADATA.SCHEMACHANGE.CHANGE_HISTORY'}, {'id': '36540301736827091977708984686545449838273515917612744712', 'timestamp': 1638523798713, 'message': 'Max applied change script version: None'}, {'id': '36540301736827091977708984686545449838273515917612744713', 'timestamp': 1638523798713, 'message': 'Applying change script V1.12__createTable.sql'}, {'id': '36540301736827091977708984686545449838273515917612744714', 'timestamp': 1638523798713, 'message': 'Applying change script V1.13__createTable1.sql'}, {'id': '36540301736827091977708984686545449838273515917612744715', 'timestamp': 1638523798713, 'message': 'Applying change script V1.15__time_demo.sql'}, {'id': '36540301736827091977708984686545449838273515917612744716', 'timestamp': 1638523798713, 'message': 'Applying change script V1.16__time_demo_v1.sql'}, {'id': '36540301736827091977708984686545449838273515917612744717', 'timestamp': 1638523798713, 'message': 'Applying change script V1.17__time_demo_v2.sql'}, {'id': '36540301736827091977708984686545449838273515917612744718', 'timestamp': 1638523798713, 'message': 'Applying change script V1.18__time_demo_v3.sql'}, {'id': '36540301736827091977708984686545449838273515917612744719', 'timestamp': 1638523798713, 'message': 'Applying change script V1.19__time_demo_v4.sql'}, {'id': '36540301736827091977708984686545449838273515917612744720', 'timestamp': 1638523798713, 'message': 'Applying change script V1.20__time_demo_v7.sql'}, {'id': '36540301736827091977708984686545449838273515917612744721', 'timestamp': 1638523798713, 'message': 'Applying change script V1.21__time_demo_v1.sql'}, {'id': '36540301736827091977708984686545449838273515917612744722', 'timestamp': 1638523798713, 'message': 'Applying change script V1.22__time_demo_v1.sql'}, {'id': '36540301736827091977708984686545449838273515917612744723', 'timestamp': 1638523798713, 'message': 'Applying change script V1.23__time_demo_test.sql'}, {'id': '36540301736827091977708984686545449838273515917612744724', 'timestamp': 1638523798713, 'message': 'Applying change script V1.24__time_demo.sql'}, {'id': '36540301736827091977708984686545449838273515917612744725', 'timestamp': 1638523798713, 'message': 'Applying change script V1.25__EY_DEMO_v1.sql'}, {'id': '36540301736827091977708984686545449838273515917612744726', 'timestamp': 1638523798713, 'message': 'Applying change script V1.26__EY_demo_v2.sql'}, {'id': '36540301736827091977708984686545449838273515917612744727', 'timestamp': 1638523798713, 'message': 'Applying change script V1.27__EY_DEMO_v3.sql'}, {'id': '36540301736827091977708984686545449838273515917612744728', 'timestamp': 1638523798713, 'message': 'Successfully applied 15 change scripts (skipping 0)'}, {'id': '36540301736827091977708984686545449838273515917612744729', 'timestamp': 1638523798713, 'message': 'Completed successfully'}, {'id': '36540301745435179624341805219178237091515783458921185306', 'timestamp': 1638523799099, 'message': '*** Snowflake job completed ***'}]


# l=[]
# for dic in st3:
#     for key in dic.values():
#         l.append(key)
print("********************values*************************************")
#print(l)
#k=[]
#for dic1 in st1:
#    for key1 in dic1.keys():
#        k.append(key1)
#print("********************keys*************************************")
#print(k)



# def ee():
#     for i in l:
#         for k in f1:
#             if k in str(i):
#                 print((i))

# j=ee()
# print(j)

# for i in l:
#     for k in f1:
#         if k in str(i):
#             #print((i))
#             res=i


#print(type(res))
#print(res)

def error_msg():
    f1=['snowflake.connector.errors.DatabaseError:','syntax error','Completed successfully']
    l=[]
    for dic in st3:
        for key in dic.values():
            l.append(key)
    
    for i in l:
        for k in f1:
            if k in str(i):
            #print((i))
             res=i
       
    if type(res)==str:
        print(res)
    else:
        print(None)

error_msg()






    




    



